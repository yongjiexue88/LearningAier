# LearningAier Project Documentation

## Project Overview
LearningAier is a full-stack application designed to assist with learning through AI-powered features. It leverages Google Gemini for AI capabilities, Firebase for authentication and data storage, and a modern React frontend.

## Technology Stack

### Backend
- **Runtime**: Node.js 20+, Express 4, TypeScript
- **Core Services**: 
  - **Firebase Auth**: User authentication
  - **Firestore**: NoSQL database
  - **Cloud Storage**: File storage (PDFs, images)
- **AI Integration**: 
  - **Google Gemini**: Models `gemini-2.5-flash`, `text-embedding-004`
  - **Library**: `@google/genai`
- **Utilities**: `pdf-parse` for PDF processing

### Frontend
- **Framework**: Vite, React, TypeScript
- **Styling**: Tailwind CSS, Material UI (MUI)
- **State Management**: React Query (`@tanstack/react-query`)
- **Markdown Rendering**: `react-markdown`, `rehype-raw`, `remark-gfm`
- **Deployment**: Firebase Hosting

## Architecture
The application follows a client-server architecture where the frontend interacts with the backend via RESTful APIs and directly with Firebase services for some operations.

1.  **Frontend**: hosted on Firebase Hosting. It handles user UI, authentication (via Firebase SDK), and direct Firestore reads/writes for standard CRUD operations (folders, notes, tasks).
2.  **Backend**: An Express server running on a dedicated port (default 8787). It exposes endpoints under `/functions/v1/*` for complex AI operations (translation, Q&A, flashcard generation) that require server-side processing or secret management.
3.  **Data Layer**: Firestore is the single source of truth for application state. Cloud Storage is used for large assets like PDFs and images.

## Key Directories

### `/backend`
-   `src/server.ts`: Entry point for the Express server.
-   `src/routes`: API route definitions.
-   `src/services`: Business logic and integrations (Gemini, Firebase).
-   `src/llm`: LLM-specific logic and prompts.
-   `src/embeddings`: Logic for generating and managing vector embeddings.
-   `dist`: Compiled JavaScript output.

### `/frontend`
-   `src/pages`: React components representing application pages.
-   `src/components`: Reusable UI components.
-   `src/lib`: Utility functions and configurations.
-   `src/services`: API client and service abstractions.
-   `vite.config.ts`: Vite configuration.
-   `tailwind.config.js`: Tailwind CSS configuration.

### `/.github`
-   `workflows`: CI/CD pipelines for deploying to Firebase Hosting on merge and pull requests.

## Data Model (Firestore)
-   `profiles`: User preferences (LLM provider/model).
-   `folders`: Hierarchical organization for content.
-   `notes`: Main content units (bilingual markdown).
-   `note_chunks`: Vector embeddings for RAG (Retrieval-Augmented Generation).
-   `documents`: Metadata for uploaded files (PDFs).
-   `flashcards`: Spaced repetition items.
-   `flashcard_reviews`: Review history for flashcards.

## API Surface (`/functions/v1/*`)
-   `/ai-notes-translate`: Translate notes.
-   `/ai-notes-terminology`: Extract terminology.
-   `/ai-notes-qa`: Question answering with RAG.
-   `/documents-upload-process`: Process uploaded PDFs.
-   `/notes-reindex`: Generate embeddings for notes.
-   `/ai-flashcards-generate`: Create flashcards from content.
-   `/flashcards-review`: Submit flashcard review results.

## Development Workflow

### Setup
1.  **Install Dependencies**: `npm install` in both `backend` and `frontend`.
2.  **Environment Variables**:
    -   Backend: Copy `.env.local` and populate Firebase and Gemini keys.
    -   Frontend: Ensure `.env.local` contains Firebase public config and `VITE_API_BASE_URL`.

### Running Locally
1.  **Backend**: `npm run dev` (starts server on port 8787).
2.  **Frontend**: `npm run dev` (starts Vite dev server).

### Deployment
-   **Frontend**: Deployed to Firebase Hosting via GitHub Actions or `firebase deploy --only hosting`.
-   **Backend**: Built via `npm run build` and run via `npm start`. (Deployment target for backend is likely a container or VM, distinct from Firebase Functions given the Express setup, though it could be adapted).
